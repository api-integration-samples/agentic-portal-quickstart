<!doctype html>
<html lang="en" class="dark">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Apigee Agentic Portal</title>
        <link rel="icon" type="image/x-icon" href="/favicon.png" />
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="https://www.gstatic.com/firebasejs/8.0/firebase.js"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
            rel="stylesheet"
        />
        <style>
            :root {
                /* Dark mode colors */
                --bg-primary: #0f172a;
                --bg-secondary: #1e293b;
                --bg-tertiary: #334155;
                --text-primary: #f8fafc;
                --text-secondary: #cbd5e1;
                --text-tertiary: #64748b;
                --text-title: rgb(129, 140, 248, 1);
                --border: #334155;
                --shadow: rgba(0, 0, 0, 0.3);
                --accent: #60a5fa;
                --accent-hover: #3b82f6;
                --user-bg: #3b82f6;
                --user-text: #ffffff;
                --ai-bg: #1e293b;
                --ai-text: #f8fafc;
                --input-bg: #1e293b;
                --header-bg: rgba(15, 23, 42, 0.8);
            }

            [data-theme="light"] {
                /* Light mode colors */
                --bg-primary: #ffffff;
                --bg-secondary: #f8fafc;
                --bg-tertiary: #f1f5f9;
                --text-primary: #0f172a;
                --text-secondary: #475569;
                --text-tertiary: #94a3b8;
                --text-title: rgb(79, 70, 229, 1);
                --border: #e2e8f0;
                --shadow: rgba(0, 0, 0, 0.05);
                --accent: #3b82f6;
                --accent-hover: #2563eb;
                --user-bg: #3b82f6;
                --user-text: #ffffff;
                --ai-bg: #f1f5f9;
                --ai-text: #0f172a;
                --input-bg: #ffffff;
                --header-bg: rgba(255, 255, 255, 0.8);
            }
            body {
                font-family: "Inter", sans-serif;
                background: var(--bg-primary);
                color: var(--text-primary);
                transition: all 0.3s ease;
            }

            .menu-item:hover {
                background-color: var(--bg-tertiary);
                color: var(--text-primary);
            }
        </style>
    </head>
    <body class="">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Header -->
            <header
                class="flex justify-between items-center py-6"
                style="white-space: nowrap"
            >
                <div class="text-2xl font-bold tracking-tight">
                    <a href="/">
                        <span style="color: var(--text-title)">Apigee</span>
                        <span class="hidden md:inline">Agentic Portal</span></a
                    >
                </div>

                <div style="display: flex; align-items: center">
                    <a
                        href="/tools"
                        class="relative pr-4 md:pr-8 font-bold right-0 text-lg"
                        >Tools</a
                    >

                    <a
                        href="/agents"
                        class="relative pr-4 md:pr-8 font-bold right-0 text-lg"
                        >Agents</a
                    >

                    <a
                        id="sign_in_button"
                        style="display: none"
                        href="/signin"
                        class="relative pr-4 md:pr-8 font-bold right-0 text-lg"
                        >Sign in</a
                    >

                    <!-- Account Dropdown -->
                    <div
                        id="account_button"
                        style="display: none"
                        class="relative"
                    >
                        <button
                            id="account-dropdown-button"
                            style="background-color: var(--bg-tertiary)"
                            class="flex items-center space-x-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 rounded-full p-2 transition duration-150 ease-in-out"
                        >
                            <svg
                                class="h-6 w-6 text-gray-500 dark:text-gray-400"
                                fill="none"
                                viewBox="0 0 24 24"
                                stroke="currentColor"
                            >
                                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                <g
                                    id="SVGRepo_tracerCarrier"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                ></g>
                                <g id="SVGRepo_iconCarrier">
                                    <path
                                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"
                                    ></path>
                                </g>
                            </svg>
                            <span
                                style="color: var(--text-secondary)"
                                class="font-medium text-gray-900 dark:text-white hidden md:inline"
                                >Account</span
                            >
                            <svg
                                class="h-4 w-4 text-gray-500 dark:text-gray-400"
                                fill="none"
                                viewBox="0 0 24 24"
                                stroke="currentColor"
                            >
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M19 9l-7 7-7-7"
                                />
                            </svg>
                        </button>

                        <!-- Dropdown Menu -->
                        <div
                            id="account-dropdown-menu"
                            style="background-color: var(--bg-secondary)"
                            class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg shadow-xl py-1 z-10 opacity-0 dropdown-menu"
                        >
                            <a
                                href="/apps"
                                style="color: var(--text-primary)"
                                class="menu-item block px-4 py-2 text-gray-700 dark:text-gray-300"
                                >Apps</a
                            >
                            <button
                                onclick="signOut()"
                                style="
                                    color: var(--text-primary);
                                    width: 100%;
                                    text-align: left;
                                "
                                class="menu-item block px-4 py-2 text-gray-700 dark:text-gray-300"
                            >
                                Sign-Out
                            </button>
                        </div>
                    </div>

                    <button
                        class="relative pl-4 theme-toggle"
                        onclick="toggleTheme()"
                    >
                        <svg
                            class="theme-icon-light"
                            width="20"
                            height="20"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
                            />
                        </svg>
                        <svg
                            class="theme-icon-dark"
                            width="20"
                            height="20"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                            style="display: none"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
                            />
                        </svg>
                    </button>
                </div>
            </header>

            <main class="space-y-12 mt-6 sm:mt-12">
                <!-- Primary Agents Showcase -->
                <section class="mb-4">
                    <h2
                        class="text-4xl font-bold mb-8 border-b border-indigo-200 dark:border-indigo-800 pb-3"
                    >
                        Agent Spotlight
                    </h2>

                    <div class="grid md:grid-cols-2 gap-8">
                        <!-- APIGEE AGENT Card -->
                        <div
                            style="background-color: var(--bg-secondary)"
                            class="card-hover bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 transition duration-300"
                        >
                            <div class="flex items-start space-x-6">
                                <!-- Icon: Data Stream / Performance -->
                                <div
                                    class="flex-shrink-0 p-4 bg-indigo-100 dark:bg-indigo-900 rounded-full text-indigo-600 dark:text-indigo-300"
                                >
                                    <svg
                                        class="nav-icon w-10 h-10"
                                        fill="none"
                                        stroke="currentColor"
                                        viewBox="0 0 24 24"
                                        xmlns="http://www.w3.org/2000/svg"
                                        stroke-width="2"
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                    >
                                        <g
                                            id="SVGRepo_bgCarrier"
                                            stroke-width="0"
                                        ></g>
                                        <g
                                            id="SVGRepo_tracerCarrier"
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                        ></g>
                                        <g id="SVGRepo_iconCarrier">
                                            <rect
                                                x="3"
                                                y="11"
                                                width="18"
                                                height="10"
                                                rx="2"
                                            ></rect>
                                            <circle
                                                cx="12"
                                                cy="5"
                                                r="2"
                                            ></circle>
                                            <path d="M12 7v4"></path>
                                            <line
                                                x1="8"
                                                y1="16"
                                                x2="8"
                                                y2="16"
                                            ></line>
                                            <line
                                                x1="16"
                                                y1="16"
                                                x2="16"
                                                y2="16"
                                            ></line>
                                        </g>
                                    </svg>
                                </div>
                                <div class="flex-grow">
                                    <h3
                                        class="text-2xl font-semibold mb-2 text-indigo-600 dark:text-indigo-400"
                                    >
                                        Apigee Agent
                                    </h3>
                                    <p class="mb-6">
                                        Focuses on discovering agentic tools,
                                        managing subscriptions & account
                                        information, as well as viewing
                                        analytics and usage data.
                                    </p>
                                    <a
                                        href="/agent"
                                        class="inline-block px-6 py-2 bg-indigo-600 text-white font-medium text-sm rounded-lg hover:bg-indigo-700 transition duration-200 shadow-md shadow-indigo-500/50"
                                    >
                                        Open Agent &rarr;
                                    </a>
                                </div>
                            </div>
                        </div>
                        <!-- G4E AGENT Card -->
                        <div
                            style="background-color: var(--bg-secondary)"
                            class="card-hover bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 transition duration-300"
                        >
                            <div class="flex items-start space-x-6">
                                <!-- Icon: Settings / Administration -->
                                <div
                                    class="flex-shrink-0 p-4 bg-purple-100 dark:bg-purple-900 rounded-full text-purple-600 dark:text-purple-300"
                                >
                                    <svg
                                        class="w-10 h-10"
                                        xmlns="http://www.w3.org/2000/svg"
                                        xml:space="preserve"
                                        viewBox="0 0 512 512"
                                    >
                                        <radialGradient
                                            id="a"
                                            cx="-37.129"
                                            cy="650.866"
                                            r="32"
                                            gradientUnits="userSpaceOnUse"
                                        >
                                            <stop
                                                offset=".067"
                                                style="stop-color: #9168c0"
                                            />
                                            <stop
                                                offset=".343"
                                                style="stop-color: #c084fc"
                                            />
                                            <stop
                                                offset=".672"
                                                style="stop-color: #c084fc"
                                            />
                                        </radialGradient>
                                        <path
                                            d="M512 256.5c-137.5 8.4-247.1 118-255.5 255.5h-1C247.1 374.5 137.5 264.9 0 256.5v-1c137.5-8.4 247.1-118 255.5-255.5h1c8.4 137.5 118 247.1 255.5 255.5z"
                                            style="fill: url(#a)"
                                        />
                                    </svg>
                                    <!--<svg
                                        class="w-10 h-10"
                                        fill="none"
                                        stroke="currentColor"
                                        viewBox="0 0 24 24"
                                        xmlns="http://www.w3.org/2000/svg"
                                        stroke-width="1.5"
                                    >
                                        <path
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            d="M3 13.5l6-6 6 6 6-6M3 21h18M3 3h18"
                                        />
                                    </svg>-->
                                </div>
                                <div class="flex-grow">
                                    <h3
                                        class="text-2xl font-semibold mb-2 text-purple-600 dark:text-purple-400"
                                    >
                                        Enterprise Agent
                                    </h3>
                                    <p class="mb-6">
                                        Bring the best of Google AI to every
                                        employee, for every workflow. Empower
                                        teams to discover, create, share, and
                                        run AI agents all in one secure
                                        platform.
                                    </p>
                                    <a
                                        href="https://cloud.google.com/gemini-enterprise"
                                        target="_blank"
                                        class="inline-block px-6 py-2 bg-purple-600 text-white font-medium text-sm rounded-lg hover:bg-purple-700 transition duration-200 shadow-md shadow-purple-500/50"
                                    >
                                        More Info &rarr;
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Additional Agents List -->
                <section>
                    <h2
                        class="text-4xl font-bold mb-8 border-b border-indigo-200 dark:border-indigo-800 pb-3"
                    >
                        Agent Catalogue
                    </h2>
                    <p class="text-gray-500 dark:text-gray-400 mb-8 max-w-2xl">
                        Explore specialized agents designed for focused tasks to
                        enhance security, optimize costs, and streamline
                        development processes.
                    </p>

                    <div class="flex flex-col md:flex-col gap-4 mb-8">
                        <input
                            id="search-input"
                            type="text"
                            placeholder="Search by tool name..."
                            style="
                                background-color: var(--bg-primary);
                                color: var(--text-primary);
                            "
                            class="flex-1 p-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 outline-none transition-all duration-200"
                        />

                        <div
                            id="protocol-select"
                            class="flex items-center space-x-2 overflow-x-auto pb-2"
                        >
                            <button
                                id="all-button"
                                onclick="typeButtonClick(event)"
                                data-type="All"
                                class="filter-btn px-4 py-2 rounded-full font-medium text-sm transition-colors duration-200 bg-blue-500 text-white shadow-md hover:bg-blue-600 active:bg-blue-700"
                            >
                                All
                            </button>
                        </div>
                    </div>

                    <!-- API Products Grouped by Topic -->
                    <div id="product-container" class="space-y-12">
                        <!-- Products will be dynamically injected here by JavaScript -->
                    </div>
                </section>
            </main>

            <!-- Footer -->
            <footer class="text-center py-8 text-gray-500 dark:text-gray-400">
                <p>&copy; 2025-2026. All rights reserved.</p>
            </footer>
        </div>

        <script>
            // THEME
            const themeToggle = document.getElementById("theme-toggle");
            const savedTheme = localStorage.getItem("theme") || "dark";
            setTheme(savedTheme);
            function toggleTheme() {
                const currentTheme = document.body.getAttribute("data-theme");
                const newTheme = currentTheme === "light" ? "dark" : "light";

                setTheme(newTheme);
            }

            function setTheme(newTheme) {
                const lightIcon = document.querySelector(".theme-icon-light");
                const darkIcon = document.querySelector(".theme-icon-dark");

                document.body.setAttribute("data-theme", newTheme);
                localStorage.setItem("theme", newTheme);

                if (newTheme === "dark") {
                    lightIcon.style.display = "none";
                    darkIcon.style.display = "block";
                } else {
                    lightIcon.style.display = "block";
                    darkIcon.style.display = "none";
                }
            }

            // USER
            let config = {};
            let user = undefined;
            setUser();
            fetch("/config")
                .then((response) => {
                    if (response.status == 200) return response.json();
                    else
                        console.error("Could not load app config from server.");
                })
                .then((appConfig) => {
                    config = appConfig;
                    firebase.initializeApp({
                        apiKey: config.authApiKey,
                        authDomain: config.authDomain,
                    });

                    firebase.auth().onAuthStateChanged((newUser) => {
                        if (newUser) {
                            user = newUser;
                            localStorage.setItem("user_email", user.email);
                            setUser();
                        } else {
                            setUser();
                        }
                    });
                });

            function signOut() {
                localStorage.removeItem("user_email");
                firebase
                    .auth()
                    .signOut()
                    .then(function () {
                        window.location.href = "/";
                    });
            }

            function setUser() {
                let user_email = localStorage.getItem("user_email");
                if (user_email) {
                    document.getElementById("account_button").style.display =
                        "block";
                    document.getElementById("sign_in_button").style.display =
                        "none";
                } else {
                    document.getElementById("account_button").style.display =
                        "none";
                    document.getElementById("sign_in_button").style.display =
                        "block";
                }
            }

            const dropdownButton = document.getElementById(
                "account-dropdown-button",
            );
            const dropdownMenu = document.getElementById(
                "account-dropdown-menu",
            );

            // --- Dropdown Logic ---
            dropdownButton.addEventListener("click", () => {
                const isExpanded =
                    dropdownButton.getAttribute("aria-expanded") === "true" ||
                    false;
                dropdownButton.setAttribute("aria-expanded", !isExpanded);
                if (dropdownMenu.classList.contains("hidden")) {
                    dropdownMenu.classList.remove("hidden");
                    // Trigger a reflow to ensure the transition runs
                    dropdownMenu.offsetHeight;
                    dropdownMenu.classList.add("opacity-100", "translate-y-0");
                    dropdownMenu.classList.remove("opacity-0", "translate-y-2");
                } else {
                    dropdownMenu.classList.remove(
                        "opacity-100",
                        "translate-y-0",
                    );
                    dropdownMenu.classList.add("opacity-0", "translate-y-2");
                    setTimeout(() => {
                        dropdownMenu.classList.add("hidden");
                    }, 200); // Match transition duration
                }
            });

            // Close dropdown if user clicks outside
            window.addEventListener("click", (event) => {
                if (
                    !dropdownButton.contains(event.target) &&
                    !dropdownMenu.contains(event.target)
                ) {
                    dropdownMenu.classList.add(
                        "hidden",
                        "opacity-0",
                        "translate-y-2",
                    );
                    dropdownMenu.classList.remove(
                        "opacity-100",
                        "translate-y-0",
                    );
                    dropdownButton.setAttribute("aria-expanded", "false");
                }
            });

            // Main elements
            const searchInput = document.getElementById("search-input");
            const filterDiv = document.getElementById("protocol-select");
            const filterButtons = [];
            const allFilterButton = document.getElementById("all-button");
            filterButtons.push(allFilterButton);
            const productContainer =
                document.getElementById("product-container");
            let activeTypeFilter = "All";
            const filterTypes = [];
            const products = [];
            fetch("/apis").then((response) => {
                if (response.status == 200) {
                    response.json().then((productData) => {
                        console.log(productData);
                        for (let apiProduct of productData.apis) {
                            console.log(apiProduct);
                            if (apiProduct.versions)
                                for (let apiVersion of apiProduct.versions) {
                                    // find versions that have portal publish flag set to true
                                    let apiVersionDetail = undefined;
                                    for (let version of productData.versions) {
                                        if (version.name === apiVersion) {
                                            // found it
                                            apiVersionDetail = version;
                                            break;
                                        }
                                    }

                                    if (apiVersionDetail) {
                                        let newProduct = {
                                            id: apiVersionDetail["name"],
                                            name: apiVersionDetail[
                                                "displayName"
                                            ],
                                            tags: [],
                                        };

                                        newProduct["description"] =
                                            apiVersionDetail["description"]
                                                ? apiVersionDetail[
                                                      "description"
                                                  ]
                                                : "No description provided.";

                                        newProduct["type"] = apiProduct[
                                            "apiStyle"
                                        ]
                                            ? apiProduct["apiStyle"][
                                                  "enumValues"
                                              ]["values"][0]["displayName"]
                                            : "REST";

                                        if (newProduct["type"] == "A2A") {
                                            if (
                                                !filterTypes.includes(
                                                    newProduct["type"],
                                                )
                                            )
                                                filterTypes.push(
                                                    newProduct["type"],
                                                );

                                            for (let [
                                                key,
                                                value,
                                            ] of Object.entries(
                                                apiProduct.attributes,
                                            )) {
                                                if (key.endsWith("/category")) {
                                                    newProduct["topic"] =
                                                        value["enumValues"][
                                                            "values"
                                                        ][0]["displayName"];
                                                } else if (
                                                    key.endsWith("/tags")
                                                ) {
                                                    for (let tag of value[
                                                        "enumValues"
                                                    ]["values"]) {
                                                        newProduct["tags"].push(
                                                            tag["displayName"],
                                                        );
                                                    }
                                                }
                                            }
                                            if (!newProduct["topic"])
                                                newProduct["topic"] = "General";

                                            products.push(newProduct);
                                        }
                                    }
                                }
                        }

                        filterAndRender();

                        // add protocol type buttons
                        for (let protocol of filterTypes) {
                            const button = document.createElement("button");
                            button.className =
                                "filter-btn px-4 py-2 rounded-full font-medium text-sm transition-colors duration-200 bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 hover:bg-gray-300";
                            button.setAttribute("data-type", protocol);
                            button.innerHTML = protocol;

                            button.addEventListener("click", typeButtonClick);

                            filterDiv.appendChild(button);
                            filterButtons.push(button);
                        }
                    });
                }
            });

            // API Type Icons
            const apiIcons = {
                A2A: `<svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 icon-mcp" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"></path></svg>`,
                ADK2: `<svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 icon-graphql" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="2" x2="12" y2="22"></line><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line><line x1="4.93" y1="19.07" x2="19.07" y2="4.93"></line></svg>`,
                G4E: `<svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 icon-mcp" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"></path></svg>`,
                ADK: `<svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 icon-grpc" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="9" y1="12" x2="15" y2="12"></line><line x1="12" y1="9" x2="12" y2="15"></line></svg>`,
            };

            // Function to render a single product card
            const createProductCard = (product) => {
                const card = document.createElement("div");
                card.addEventListener("click", () => {
                    viewDetails(product["id"], product["type"]);
                });
                card.className =
                    "bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md dark:shadow-xl hover:shadow-lg dark:hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1 cursor-pointer";
                card.style = "background-color: var(--bg-tertiary);";

                const tagsHtml = product.tags
                    .map(
                        (tag) =>
                            `<span class="bg-blue-500 text-white text-xs font-semibold px-2 py-1 rounded-full">${tag}</span>`,
                    )
                    .join("");

                card.innerHTML = `
                <div class="flex items-start justify-between mb-4 ${product.type === "A2A" ? "text-blue-500 text-white" : product.type === "GraphQL" ? "text-pink-500 text-white" : product.type === "MCP" ? "text-purple-500 text-white" : "text-orange-500 text-white"}">
                    ${apiIcons[product.type]}
                    <span class="text-sm font-bold px-3 py-1 rounded-full ${product.type === "A2A" ? "bg-blue-500 text-white" : product.type === "GraphQL" ? "bg-pink-500 text-white" : product.type === "MCP" ? "bg-purple-500 text-white" : "bg-orange-500 text-white"}">${product.type}</span>
                </div>
                <h3 class="text-2xl font-semibold mb-2">${product.name}</h3>
                <p class="text-gray-500 dark:text-gray-400 mb-4">${product.description}</p>
                <div class="flex flex-wrap gap-2 mb-4">
                    ${tagsHtml}
                </div>
                <button style="background-color: var(--accent);" class="mt-auto px-4 py-2 text-sm font-medium text-white bg-gray-900 dark:bg-gray-700 rounded-lg hover:bg-gray-800 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors duration-200">View Details</button>
            `;
                return card;
            };

            // This function would typically show a modal or navigate to a new page
            const viewDetails = (id, type) => {
                console.log("View details for product ID:", id);
                window.location.href = "/tool?id=" + id + "&type=" + type;
            };

            // Expose the function to the global scope so it can be called from the HTML
            window.viewDetails = viewDetails;

            // Function to render all products, grouped by topic
            const renderProducts = (filteredProducts) => {
                // Clear the container first
                productContainer.innerHTML = "";

                // Group products by topic
                const groupedByTopic = filteredProducts.reduce(
                    (acc, product) => {
                        const topic = product.topic;
                        if (!acc[topic]) {
                            acc[topic] = [];
                        }
                        acc[topic].push(product);
                        return acc;
                    },
                    {},
                );

                // Create and append a section for each topic
                Object.keys(groupedByTopic).forEach((topic) => {
                    const topicSection = document.createElement("div");
                    topicSection.className = "topic-section";
                    topicSection.innerHTML = `<h2 class="text-3xl font-bold mb-6">${topic}</h2>`;

                    const cardsContainer = document.createElement("div");
                    cardsContainer.className =
                        "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6";

                    groupedByTopic[topic].forEach((product) => {
                        const card = createProductCard(product);
                        cardsContainer.appendChild(card);
                    });

                    topicSection.appendChild(cardsContainer);
                    productContainer.appendChild(topicSection);
                });

                // Show a message if no products are found
                if (filteredProducts.length === 0) {
                    productContainer.innerHTML = `<p class="text-center text-lg text-gray-500 dark:text-gray-400">No products found for this query.</p>`;
                }
            };

            // Function to filter and render products
            const filterAndRender = () => {
                const query = searchInput.value.toLowerCase();
                const filtered = products.filter((product) => {
                    const matchesSearch = product.name
                        .toLowerCase()
                        .includes(query);
                    const matchesType =
                        activeTypeFilter === "All" ||
                        product.type === activeTypeFilter;
                    return matchesSearch && matchesType;
                });
                renderProducts(filtered);
            };

            const typeButtonClick = (e) => {
                let button = e.srcElement;
                // Update active filter and re-render
                activeTypeFilter = button.dataset.type;

                // Update button styles
                filterButtons.forEach((btn) => {
                    if (btn.dataset.type === activeTypeFilter) {
                        btn.classList.remove(
                            "bg-gray-200",
                            "text-gray-700",
                            "dark:bg-gray-700",
                            "dark:text-gray-200",
                            "dark:hover:bg-gray-600",
                            "hover:bg-gray-300",
                        );
                        btn.classList.add(
                            "bg-blue-500",
                            "text-white",
                            "shadow-md",
                            "hover:bg-blue-600",
                            "active:bg-blue-700",
                        );
                    } else {
                        btn.classList.remove(
                            "bg-blue-500",
                            "text-white",
                            "shadow-md",
                            "hover:bg-blue-600",
                            "active:bg-blue-700",
                        );
                        btn.classList.add(
                            "bg-gray-200",
                            "text-gray-700",
                            "dark:bg-gray-700",
                            "dark:text-gray-200",
                            "dark:hover:bg-gray-600",
                            "hover:bg-gray-300",
                        );
                    }
                });

                filterAndRender();
            };

            // Event Listeners
            searchInput.addEventListener("input", filterAndRender);

            // Initial render on page load
            document.addEventListener("DOMContentLoaded", () => {
                // filterAndRender();
            });
        </script>
    </body>
</html>
